<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="rail.bike.demo.db.ItemMapper">

    <select id="selectItem" resultType="hashMap">
        select item_code
              ,fn_code_name(item_code, 'item') item_name
              ,unit_code
              ,fn_code_name(unit_code, 'unit') unit_name
              ,price
              ,`order`
          from tb_item_mstr
    </select>

    <select id="insertItem" parameterType="hashMap" resultType="int">
        select fn_put_item(#{item_code}, #{item_name}, #{unit_name}, #{price}, #{order})
    </select>

    <select id="deleteItem" parameterType="hashMap" resultType="int">
        select fn_delete_item(#{item_code})
    </select>

    <select id="selectOrderList" resultType="hashMap">
        select row_number() over() order_seq
             , order_info.*
             , item_price + labor total_price
          from (
                select order_uniq
                     , order_date
                     , bike_number
                     , item_code
                     , fn_code_name(item_code, 'item') item_name
                     , count
                     , (select price from tb_item_mstr tim where tim.item_code = tom.item_code) * count item_price
                     , labor
                  from tb_order_mstr tom
               ) order_info
    </select>

    <select id="selectUnitList" resultType="hashMap">
        select *
          from vw_unit_info
    </select>
</mapper>